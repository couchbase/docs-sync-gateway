= Access Control Overview
// BEGIN -- PAGE -- access-control.adoc
// BEGIN PAGE DEFINITION
//  LOCATION modules/ROOT/pages/
//  PURPOSE:
//    This is a standard content presentations page.
//    Its name/title identify the content/topic
//  PARAMETERS:
//    None
//  INCLUSION USAGE --
//    This module uses attributes from:
//    - /modules/ROOT/pages/_partials/_page-index.adoc -- xref page links
//
//    This module uses these inclusions:
//    - /modules/ROOT/pages/_partials/_std-hdr-sgw.adoc -- std attribute environment
//    - /modules/ROOT/pages/_partials/block-abstract.adoc --  std text block for page header content
//    - /modules/ROOT/pages/_partials/block-related-content-deploy.adoc --  std text block for page footer content
//    - modules/ROOT/assets/images -- .png/.jpeg images
//  INCLUSION USAGE
// END PAGE DEFINITION
:description: How to implement Sync Gateway access controls in the Sync Function using access grants, users, roles and channels

include::partial$_std-hdr-sgw.adoc[]

:param-topic-group: access-control
:param-abstract: pass:q[The sync function API provides several methods that you can use to validate and control user access to databases and documents.]
include::partial$block-abstract.adoc[]

:channel1: pass:q,a[_Channel #1_]
:channel2: pass:q,a[_Channel #2_]
:channel3: pass:q,a[_Channel #3_]

:edge1: pass:q,a[_Edge #1_]
:edge2: pass:q,a[_Edge #2_]


== Access Control Entities

{channels--xref} are a key part of Sync Gateway's access control approach -- see: <<img-access-control-model>>

Every document is assigned to a channel (you can also think of these as tags).

[#img-access-control-model]
.Access Control Model
image::access-control-triangle.png[,600]

{users--xref} granted access to a channel are able to access the documents assigned to that channel.
Users can also be assigned to a role.

{roles--xref} enable the grouping togethers of users with similar characteristics, which makes the management of large user populations easier.

Roles are granted access to channels.
Any user assigned a role can access any channels (and documents within those channels) the role has been granted access to.

There is a many to many relationship between the entities, so:

* Many documents to a channel
* A document can be assigned to multiple channels
* A user can be assigned to multiple roles
* Roles and users can be granted access to multiple channels


== Access Control In Action

An example of how access control work can be seen in <<img-channels-example>>.

This example shows three separate channels; one shared channel and two private channels.
Here {edge1} and {edge2} are Sync Gateway users.


[#img-channels-example]
.Access Controls Example
image::channels-example-all.png[,600]

=== Document Routing

* All the documents for {edge1} are assigned to {channel1}.

* Documents for {edge2} are assigned to {channel2}.

* Documents required by both {edge1} and {edge2} are assigned the shared channel {channel3}

=== Access Grants

* {edge1} is granted access to {channel1} and {channel3}
* {edge2} is granted access to {channel2} and {channel3}

=== Outcome

* {edge1} can access documents in {channel1} and {channel3}
* {edge2} can access documents in {channel2} and {channel3}


== Controlling Assignments and Grants

image:label-1-group.png[,50] Documents are assigned to channel using the Sync Function's {sync-function--xref-channel-cmd} API.

image:label-2-group.png[,50] User are granted access to channel:
+
* Statically using the Sync Gateway Configuration File's {configuration-schema-static--xref--databases-user-admin-channels} setting
* At the time of user creation with Admin REST Endpoint  {rest-api-admin-user--xref} using `admin_channel`
* Using the Sync Function's {sync-function--xref-access-cmd}.

image::channel-access-grant-all.png[,600]


include::partial$block-related-content-sync.adoc[]

// END -- PAGE -- access-control.adoc
